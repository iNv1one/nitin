# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ø–∞—Ä—Å–µ—Ä–∞ –∏ —á–∞—Ç–æ–≤

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

–î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º —Å —á–∞—Ç–∞–º–∏:

1. **–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø–∞—Ä—Å–µ—Ä–∞** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ —á–∞—Ç—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥—ã–π —á–∞—Ç, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ –æ–Ω –±–æ—Ç—É
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** - –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ —á–∞—Ç—ã –≤ –±–∞–∑–µ
4. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∫–æ–ª—å–∫–æ —á–∞—Ç–æ–≤ –¥–æ—Å—Ç—É–ø–Ω–æ/–Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ
5. **–î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–∑ –∫–∞–∫–æ–≥–æ —á–∞—Ç–∞ –ø—Ä–∏—à–ª–æ —Å–æ–æ–±—â–µ–Ω–∏–µ

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

### 1. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
cd /root/nitinleads
git pull
```

### 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–µ—Ä

–ú–æ–∂–Ω–æ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É Django –∏–ª–∏ –∫–æ–º–∞–Ω–¥–æ–π:

```bash
sudo systemctl restart telegram-parser-celery.service
```

### 3. –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

```bash
sudo journalctl -u telegram-parser-celery.service -f
```

–ò–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 200 —Å—Ç—Ä–æ–∫:

```bash
sudo journalctl -u telegram-parser-celery.service -n 200 --no-pager
```

## –ß—Ç–æ –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö

### –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø–∞—Ä—Å–µ—Ä–∞:

```
================================================================================
üìä –ó–ê–ì–†–£–ó–ö–ê –ß–ê–¢–û–í –ò–ó –ë–ê–ó–´ –î–ê–ù–ù–´–•:
   –í—Å–µ–≥–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö GlobalChat –∑–∞–ø–∏—Å–µ–π: 826
   –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö chat_id: 826
   1. –ù–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞ 1 (ID: -100123456789)
   2. –ù–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞ 2 (ID: -100987654321)
   ...
   10. –ù–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞ 10 (ID: -100111222333)
   ... –∏ –µ—â—ë 816 —á–∞—Ç–æ–≤
================================================================================
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç):

```
üîç –ü–†–û–í–ï–†–ö–ê –î–û–°–¢–£–ü–ù–û–°–¢–ò –ß–ê–¢–û–í:
  ‚úÖ 1. –†–∞–±–æ—á–∏–π —á–∞—Ç 1 (ID: -100123456789, @chatusername)
  ‚úÖ 2. –†–∞–±–æ—á–∏–π —á–∞—Ç 2 (ID: -100987654321, –ø—Ä–∏–≤–∞—Ç–Ω—ã–π)
  ‚ùå 3. Chat ID -100555666777: –ë–û–¢ –£–î–ê–õ–Å–ù –ò–ó –ß–ê–¢–ê - Chat not found
  ‚ö†Ô∏è 4. Chat ID -100888999000: –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ - Access denied
  ...
```

### –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:

```
================================================================================
üìä –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ß–ê–¢–û–í:
   ‚úÖ –î–æ—Å—Ç—É–ø–Ω—ã—Ö —á–∞—Ç–æ–≤: 734
   ‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö —á–∞—Ç–æ–≤: 92
   üìà –ü—Ä–æ—Ü–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏: 88.9%

‚ö†Ô∏è –ù–ï–î–û–°–¢–£–ü–ù–´–ï –ß–ê–¢–´ (–≤–æ–∑–º–æ–∂–Ω–æ –±–æ—Ç —É–¥–∞–ª—ë–Ω):
   - Chat ID -100555666777: Chat not found
   - Chat ID -100888999000: Peer id invalid
   ...

üóëÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ 92 –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö —á–∞—Ç–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
================================================================================

üéØ –ë—É–¥–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å—Å—è 734 –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —á–∞—Ç–æ–≤
```

### –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:

```
üîî –ù–û–í–û–ï –°–û–û–ë–©–ï–ù–ò–ï! –ß–∞—Ç: –ù–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞ (ID: -100123456789), Message ID: 12345
   –¢–µ–∫—Å—Ç: –ü—Ä–æ–¥–∞–º –∞–π—Ñ–æ–Ω 15 –ø—Ä–æ –º–∞–∫—Å...
```

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ª–æ–≥–æ–≤

### –ù–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫–∏ —Å –∑–∞–≥—Ä—É–∑–∫–æ–π —á–∞—Ç–æ–≤:

```bash
sudo journalctl -u telegram-parser-celery.service -n 1000 --no-pager | grep "–ó–ê–ì–†–£–ó–ö–ê –ß–ê–¢–û–í"
```

### –ù–∞–π—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:

```bash
sudo journalctl -u telegram-parser-celery.service -n 1000 --no-pager | grep "–ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê"
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–∫–æ–ª—å–∫–æ —á–∞—Ç–æ–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ:

```bash
sudo journalctl -u telegram-parser-celery.service -n 1000 --no-pager | grep "–ù–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö —á–∞—Ç–æ–≤"
```

### –ù–∞–π—Ç–∏ —Å–ø–∏—Å–æ–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö —á–∞—Ç–æ–≤:

```bash
sudo journalctl -u telegram-parser-celery.service -n 1000 --no-pager | grep "–ë–û–¢ –£–î–ê–õ–Å–ù"
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:

```bash
sudo journalctl -u telegram-parser-celery.service -n 100 --no-pager | grep "–ù–û–í–û–ï –°–û–û–ë–©–ï–ù–ò–ï"
```

### –°–∫–æ–ª—å–∫–æ —á–∞—Ç–æ–≤ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

```bash
sudo journalctl -u telegram-parser-celery.service -n 1000 --no-pager | grep "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ"
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ Django Admin

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞:

1. –ó–∞–π–¥–∏—Ç–µ –≤ **Django Admin ‚Üí Telegram Parser ‚Üí Global chats**
2. –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ: **is_active = No**
3. –í—ã —É–≤–∏–¥–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —á–∞—Ç—ã

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞:

1. ‚úÖ –í—ã —É–≤–∏–¥–∏—Ç–µ **—Ä–µ–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ** –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —á–∞—Ç–æ–≤ (–Ω–µ 826)
2. ‚úÖ –ù–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ —á–∞—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è
3. ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ BotStatus –æ–±–Ω–æ–≤–∏—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º
4. ‚úÖ –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ –∏–∑ –∫–∞–∫–æ–≥–æ —á–∞—Ç–∞ –æ–Ω–æ –ø—Ä–∏—à–ª–æ

## –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å –Ω–æ–≤—ã–º–∏ —á–∞—Ç–∞–º–∏

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —á–∞—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–∞–∑—É:

```bash
cd /root/nitinleads
source venv/bin/activate
python manage.py shell
```

```python
from apps.telegram_parser.models import GlobalChat
from apps.telegram_parser.models import UserChatSettings
from apps.users.models import User

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π —á–∞—Ç
last_chat = GlobalChat.objects.order_by('-created_at').first()
print(f"–ü–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Ç: {last_chat.name} (ID: {last_chat.chat_id})")
print(f"–ê–∫—Ç–∏–≤–µ–Ω: {last_chat.is_active}")

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–ª—è —Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤–∫–ª—é—á–µ–Ω
settings = UserChatSettings.objects.filter(global_chat=last_chat, is_enabled=True)
print(f"–í–∫–ª—é—á–µ–Ω –¥–ª—è {settings.count()} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π")

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
total_users = User.objects.filter(is_active=True).count()
print(f"–í—Å–µ–≥–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {total_users}")
```

### –ï—Å–ª–∏ —á–∞—Ç –Ω–µ –≤–∫–ª—é—á–µ–Ω –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

1. –í Django Admin: **Telegram Parser ‚Üí Global chats**
2. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π —á–∞—Ç
3. Action: **üë• –í–∫–ª—é—á–∏—Ç—å —á–∞—Ç –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
4. –ù–∞–∂–º–∏—Ç–µ **–í—ã–ø–æ–ª–Ω–∏—Ç—å**
5. –ó–∞—Ç–µ–º: Action: **üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–µ—Ä**

## –í—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏

‚è±Ô∏è **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö 826 —á–∞—Ç–æ–≤ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 5-10 –º–∏–Ω—É—Ç**

Telegram API –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ—ç—Ç–æ–º—É –ø–∞—Ä—Å–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —á–∞—Ç—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ.

## Troubleshooting

### –ï—Å–ª–∏ –ø–∞—Ä—Å–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status telegram-parser-celery.service

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—à–∏–±–∫–∏
sudo journalctl -u telegram-parser-celery.service -n 50 --no-pager
```

### –ï—Å–ª–∏ –Ω–µ –≤–∏–¥–Ω–æ –ª–æ–≥–æ–≤:

–í–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ `config/settings.py`:

```python
LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'handlers': {
        'console': {
            'class': 'logging.StreamHandler',
        },
    },
    'loggers': {
        'telegram_parser': {
            'handlers': ['console'],
            'level': 'INFO',  # –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ INFO
        },
    },
}
```

### –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —á–∞—Ç –≤ —Å–ø–∏—Å–∫–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö (–≤ –ª–æ–≥–∞—Ö)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ UserChatSettings –¥–ª—è –≤–∞—à–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç
4. –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏: –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è —Å—Ç—Ä–æ–∫–∞ "–ù–û–í–û–ï –°–û–û–ë–©–ï–ù–ò–ï"

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π:

```bash
# –¢–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
sudo journalctl -u telegram-parser-celery.service -f | grep -E "–ó–ê–ì–†–£–ó–ö–ê|–°–¢–ê–¢–ò–°–¢–ò–ö–ê|–ù–û–í–û–ï –°–û–û–ë–©–ï–ù–ò–ï|ERROR"

# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
sudo journalctl -u telegram-parser-celery.service -f | grep -i error

# –¢–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
sudo journalctl -u telegram-parser-celery.service -f | grep "–ù–û–í–û–ï –°–û–û–ë–©–ï–ù–ò–ï"
```

### –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–≥–∏ –≤ —Ñ–∞–π–ª –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:

```bash
sudo journalctl -u telegram-parser-celery.service -n 1000 --no-pager > parser_logs.txt
cat parser_logs.txt | grep "–ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê" -A 10
```
